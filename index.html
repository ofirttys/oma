<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support Fertility Preservation - OMA Submission</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.7;
            color: #2d3748;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 50px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="grid" width="50" height="50" patternUnits="userSpaceOnUse"><path d="M 50 0 L 0 0 0 50" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 0;
            font-weight: 700;
            line-height: 1.3;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .content {
            padding: 50px 40px;
        }

        .section {
            margin-bottom: 45px;
        }

        .section h2 {
            color: #667eea;
            font-size: 24px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .section h2::before {
            content: '';
            width: 5px;
            height: 28px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 3px;
            flex-shrink: 0;
        }

        .section h3 {
            color: #4a5568;
            font-size: 19px;
            margin-bottom: 14px;
            margin-top: 24px;
            font-weight: 600;
        }

        .section p {
            margin-bottom: 16px;
            color: #4a5568;
            font-size: 16px;
        }

        .section ul {
            margin-left: 28px;
            margin-bottom: 18px;
        }

        .section li {
            margin-bottom: 10px;
            color: #4a5568;
            font-size: 16px;
            padding-left: 8px;
        }

        .section li::marker {
            color: #667eea;
            font-weight: bold;
        }

        .highlight-box {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-left: 5px solid #667eea;
            padding: 24px 28px;
            margin: 24px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .highlight-box strong {
            color: #2d3748;
            font-size: 17px;
            line-height: 1.7;
        }

        .form-section {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            padding: 40px;
            border-radius: 12px;
            margin-top: 40px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .form-section h2 {
            color: #667eea;
            margin-bottom: 24px;
            font-size: 26px;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #2d3748;
            font-size: 15px;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
            line-height: 1.6;
        }

        .required {
            color: #e53e3e;
            font-weight: bold;
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 16px 40px;
            border: none;
            border-radius: 8px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            letter-spacing: 0.3px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .message {
            padding: 16px 20px;
            border-radius: 8px;
            margin-bottom: 24px;
            display: none;
            font-weight: 500;
        }

        .message.success {
            background: #c6f6d5;
            color: #22543d;
            border: 2px solid #9ae6b4;
        }

        .message.error {
            background: #fed7d7;
            color: #742a2a;
            border: 2px solid #fc8181;
        }

        .contact-info {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-left: 5px solid #f59e0b;
            padding: 20px 24px;
            margin: 24px 0 0 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .contact-info strong {
            color: #78350f;
            font-size: 16px;
        }

        .contact-info p {
            color: #78350f;
            margin-bottom: 8px;
        }

        a {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.2s ease;
        }

        a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            body {
                padding: 20px 15px;
            }

            .header {
                padding: 40px 25px;
            }

            .header h1 {
                font-size: 26px;
            }

            .content {
                padding: 35px 25px;
            }

            .form-section {
                padding: 30px 25px;
            }

            .section h2 {
                font-size: 22px;
            }
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Support a Member-Driven Initiative to Update Laparoscopy Descriptors for Fertility Preservation</h1>
        </div>

        <div class="content">
            <div class="section">
                <h2>WHY: To Ensure Equitable, Medically Appropriate Care for Patients Who Cannot Freeze Eggs</h2>
                <p>Ovarian tissue harvesting and transplantation are essential Fertility Preservation options for patients who cannot undergo oocyte cryopreservation. This includes:</p>
                <ul>
                    <li>Children and adolescents, for whom egg freezing is not possible</li>
                    <li>Patients requiring urgent chemotherapy, where treatment cannot be delayed</li>
                    <li>Individuals whose medical circumstances make egg freezing unsafe or unfeasible</li>
                </ul>
                <p>Despite being medically indicated, these procedures are not explicitly included in current gynecologic laparoscopy surgery descriptors. This omission creates barriers to transparent, fair, and medically appropriate billing, and it leaves vulnerable oncology patients without the support they deserve.</p>
                <div class="highlight-box">
                    <strong>Updating the descriptors ensures that Ontario's billing framework reflects modern reproductive medicine, supports equitable access, and aligns with the realities of Fertility Preservation care.</strong>
                </div>
            </div>

            <div class="section">
                <h2>WHAT: A Member-Driven OMA Submission to Modernize Surgical Descriptors</h2>
                <p>We are preparing a <a href="https://www.oma.org/member/your-association/get-involved/committees/physician-payment-committee/?anchor=proposals" target="_blank">member driven submission</a> within the OMA's Reproductive Biology Section to update the gynecologic laparoscopy descriptors to explicitly include:</p>
                <ul>
                    <li><strong>Ovarian tissue harvesting</strong></li>
                    <li><strong>Ovarian tissue transplantation</strong></li>
                </ul>
                <p>for the purpose of Fertility Preservation under a recognized medical indication.</p>
                
                <h3>This update will:</h3>
                <ul>
                    <li>Provide clarity for clinicians performing these procedures</li>
                    <li>Support ethical, patient-centred care</li>
                    <li>Ensure billing practices accurately reflect the medical purpose of the surgery</li>
                    <li>Reduce administrative ambiguity for providers and institutions</li>
                </ul>
                <p>To advance this submission, we require support from the Reproductive Biology Section OMA members.</p>
            </div>

            <div class="section">
                <h2>HOW: Add Your Name to Strengthen This Submission</h2>
                <p>If you are willing to support this initiative, please provide your information below.</p>
                <p>Your endorsement directly contributes to a more equitable, transparent, and clinically aligned system for Fertility Preservation in Ontario. Together, we can ensure that our most vulnerable patients receive the care and recognition they deserve.</p>
            </div>

            <div class="form-section">
                <h2>Support This Initiative</h2>
                
                <div id="statusMessage" class="message"></div>

                <form id="supportForm">
                    <div class="form-group">
                        <label for="fullName">Full Name <span class="required">*</span></label>
                        <input type="text" id="fullName" name="fullName" required>
                    </div>

<!--
                    <div class="form-group">
                        <label for="omaNumber">OMA Number <span class="required">*</span></label>
                        <input type="text" id="omaNumber" name="omaNumber" required>
                    </div>
-->
                    <div class="form-group">
                        <label for="email">Email Address <span class="required">*</span></label>
                        <input type="email" id="email" name="email" required>
                    </div>

                    <div class="form-group">
                        <label for="comments">Additional Comments (Optional)</label>
                        <textarea id="comments" name="comments" placeholder="Any additional thoughts you'd like to share..."></textarea>
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn">
                        <span id="btnText">Submit Support</span>
                    </button>
                </form>

                <div class="contact-info">
                    <p><strong>Alternative submission:</strong> You may also send your information directly to:</p>
                    <p>Dr. Jennia Michaeli<br>
                    Email: <a href="mailto:Jennia.Michaeli@sinaihealth.ca">Jennia.Michaeli@sinaihealth.ca</a><br>
                </div>
            </div>
        </div>
    </div>

    <script>
        // CONFIGURATION: Replace with your Google Apps Script Web App URL
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbySnXygHxhs8WhCkvR6pJNOvV4mbfbT6eyMHjlrJ_QLelcGk4Aq7aSpNKiT-3QO0C1BMg/exec';
        
        const form = document.getElementById('supportForm');
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const statusMessage = document.getElementById('statusMessage');

        function showMessage(message, type) {
            statusMessage.textContent = message;
            statusMessage.className = `message ${type}`;
            statusMessage.style.display = 'block';
            
            // Scroll to message
            statusMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            
            // Auto-hide success messages after 5 seconds
            if (type === 'success') {
                setTimeout(() => {
                    statusMessage.style.display = 'none';
                }, 5000);
            }
        }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Disable submit button
            submitBtn.disabled = true;
            btnText.innerHTML = '<span class="spinner"></span> Submitting...';
            statusMessage.style.display = 'none';

            // Gather form data
            const formData = {
                timestamp: new Date().toISOString(),
                fullName: document.getElementById('fullName').value.trim(),
                //omaNumber: document.getElementById('omaNumber').value.trim(),
                email: document.getElementById('email').value.trim(),
                comments: document.getElementById('comments').value.trim()
            };

            try {
                // Submit to Google Sheets via Apps Script
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                // Note: With no-cors mode, we can't read the response
                // We'll assume success if no error is thrown
                showMessage('Thank you for your support! Your information has been submitted successfully.', 'success');
                
                // Reset form
                form.reset();
                
            } catch (error) {
                console.error('Error:', error);
                showMessage('There was an error submitting your information. Please try again or contact Dr. Jennia Michaeli directly.', 'error');
            } finally {
                // Re-enable submit button
                submitBtn.disabled = false;
                btnText.textContent = 'Submit Support';
            }
        });

        // Optional: Add input validation styling
        const inputs = document.querySelectorAll('input[required], textarea[required]');
        inputs.forEach(input => {
            input.addEventListener('invalid', (e) => {
                e.target.style.borderColor = '#e74c3c';
            });
            input.addEventListener('input', (e) => {
                e.target.style.borderColor = '#e2e8f0';
            });
        });
    </script>
</body>
</html>
