<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support Fertility Preservation - OMA Submission</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .header p {
            font-size: 16px;
            opacity: 0.95;
        }

        .content {
            padding: 40px 30px;
        }

        .section {
            margin-bottom: 35px;
        }

        .section h2 {
            color: #667eea;
            font-size: 22px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section h2::before {
            content: '';
            width: 4px;
            height: 24px;
            background: #667eea;
            border-radius: 2px;
        }

        .section h3 {
            color: #555;
            font-size: 18px;
            margin-bottom: 12px;
            margin-top: 20px;
        }

        .section p {
            margin-bottom: 15px;
            color: #555;
        }

        .section ul {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .section li {
            margin-bottom: 8px;
            color: #555;
        }

        .highlight-box {
            background: #f8f9ff;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .form-section {
            background: #f8f9ff;
            padding: 30px;
            border-radius: 8px;
            margin-top: 30px;
        }

        .form-section h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .required {
            color: #e74c3c;
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 14px 40px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .message {
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            display: none;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .contact-info {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .contact-info strong {
            color: #856404;
        }

        a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 24px;
            }

            .content {
                padding: 30px 20px;
            }

            .form-section {
                padding: 20px;
            }
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Support a Member‑Driven Initiative to Update Laparoscopy Descriptors for Fertility Preservation</h1>
            <p>Ensuring Equitable, Medically Appropriate Care for Patients Who Cannot Freeze Eggs</p>
        </div>

        <div class="content">
            <div class="section">
                <h2>WHY: To Ensure Equitable, Medically Appropriate Care for Patients Who Cannot Freeze Eggs</h2>
                <p>Ovarian tissue harvesting and transplantation are essential Fertility Preservation options for patients who cannot undergo oocyte cryopreservation. This includes:</p>
                <ul>
                    <li>Children and adolescents, for whom egg freezing is not possible</li>
                    <li>Patients requiring urgent chemotherapy, where treatment cannot be delayed</li>
                    <li>Individuals whose medical circumstances make egg freezing unsafe or unfeasible</li>
                </ul>
                <p>Despite being medically indicated, these procedures are not explicitly included in current gynecologic laparoscopy surgery descriptors. This omission creates barriers to transparent, fair, and medically appropriate billing, and it leaves vulnerable oncology patients without the support they deserve.</p>
                <div class="highlight-box">
                    <strong>Updating the descriptors ensures that Ontario's billing framework reflects modern reproductive medicine, supports equitable access, and aligns with the realities of Fertility Preservation care.</strong>
                </div>
            </div>

            <div class="section">
                <h2>WHAT: A <a href="https://www.oma.org/member/your-association/get-involved/committees/physician-payment-committee/?anchor=proposals" target="_blank">Member‑Driven OMA Submission</a> to Modernize Surgical Descriptors</h2>
                <p>We are preparing a member‑driven submission within the OMA's Reproductive Biology Section to update the gynecologic laparoscopy descriptors to explicitly include:</p>
                <ul>
                    <li><strong>Ovarian tissue harvesting</strong></li>
                    <li><strong>Ovarian tissue transplantation</strong></li>
                </ul>
                <p>for the purpose of Fertility Preservation under a recognized medical indication.</p>
                
                <h3>This update will:</h3>
                <ul>
                    <li>Provide clarity for clinicians performing these procedures</li>
                    <li>Support ethical, patient‑centred care</li>
                    <li>Ensure billing practices accurately reflect the medical purpose of the surgery</li>
                    <li>Reduce administrative ambiguity for providers and institutions</li>
                </ul>
                <p>To advance this submission, we require support from the Reproductive Biology Section OMA members.</p>
            </div>

            <div class="section">
                <h2>HOW: Add Your Name to Strengthen This Submission</h2>
                <p>If you are willing to support this initiative, please provide your information below.</p>
                <p>Your endorsement directly contributes to a more equitable, transparent, and clinically aligned system for Fertility Preservation in Ontario. Together, we can ensure that our most vulnerable patients receive the care and recognition they deserve.</p>
            </div>

            <div class="form-section">
                <h2>Support This Initiative</h2>
                
                <div id="statusMessage" class="message"></div>

                <form id="supportForm">
                    <div class="form-group">
                        <label for="fullName">Full Name <span class="required">*</span></label>
                        <input type="text" id="fullName" name="fullName" required>
                    </div>

                    <div class="form-group">
                        <label for="omaNumber">OMA Number <span class="required">*</span></label>
                        <input type="text" id="omaNumber" name="omaNumber" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email Address <span class="required">*</span></label>
                        <input type="email" id="email" name="email" required>
                    </div>

                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" name="phone">
                    </div>

                    <div class="form-group">
                        <label for="institution">Institution/Practice</label>
                        <input type="text" id="institution" name="institution">
                    </div>

                    <div class="form-group">
                        <label for="comments">Additional Comments (Optional)</label>
                        <textarea id="comments" name="comments" placeholder="Any additional thoughts or support you'd like to share..."></textarea>
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn">
                        <span id="btnText">Submit Support</span>
                    </button>
                </form>

                <div class="contact-info">
                    <p><strong>Alternative submission:</strong> You may also send your information directly to:</p>
                    <p>Dr. Jennia Michaeli<br>
                    Email: <a href="mailto:Jennia.Michaeli@sinaihealth.ca">Jennia.Michaeli@sinaihealth.ca</a><br>
                    Phone: <a href="tel:437-972-4356">437-972-4356</a></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // CONFIGURATION: Replace with your Google Apps Script Web App URL
        const SCRIPT_URL = 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE';
        
        const form = document.getElementById('supportForm');
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const statusMessage = document.getElementById('statusMessage');

        function showMessage(message, type) {
            statusMessage.textContent = message;
            statusMessage.className = `message ${type}`;
            statusMessage.style.display = 'block';
            
            // Scroll to message
            statusMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            
            // Auto-hide success messages after 5 seconds
            if (type === 'success') {
                setTimeout(() => {
                    statusMessage.style.display = 'none';
                }, 5000);
            }
        }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Disable submit button
            submitBtn.disabled = true;
            btnText.innerHTML = '<span class="spinner"></span> Submitting...';
            statusMessage.style.display = 'none';

            // Gather form data
            const formData = {
                timestamp: new Date().toISOString(),
                fullName: document.getElementById('fullName').value.trim(),
                omaNumber: document.getElementById('omaNumber').value.trim(),
                email: document.getElementById('email').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                institution: document.getElementById('institution').value.trim(),
                comments: document.getElementById('comments').value.trim()
            };

            try {
                // Submit to Google Sheets via Apps Script
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                // Note: With no-cors mode, we can't read the response
                // We'll assume success if no error is thrown
                showMessage('Thank you for your support! Your information has been submitted successfully.', 'success');
                
                // Reset form
                form.reset();
                
            } catch (error) {
                console.error('Error:', error);
                showMessage('There was an error submitting your information. Please try again or contact Dr. Jennia Michaeli directly.', 'error');
            } finally {
                // Re-enable submit button
                submitBtn.disabled = false;
                btnText.textContent = 'Submit Support';
            }
        });

        // Optional: Add input validation styling
        const inputs = document.querySelectorAll('input[required], textarea[required]');
        inputs.forEach(input => {
            input.addEventListener('invalid', (e) => {
                e.target.style.borderColor = '#e74c3c';
            });
            input.addEventListener('input', (e) => {
                e.target.style.borderColor = '#e0e0e0';
            });
        });
    </script>
</body>
</html>
